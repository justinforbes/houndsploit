{% extends 'base.html' %}
{% block scripts_and_css %}
    <script>getTheme("base_searcher.css")</script>
    <script>getTheme("news.css")</script>
{% endblock %}
{% block results_table %}
    <div class="div-news-selector" id="div-news-selector" name="div-news-selector" onsubmit="resetPages()">
        <form action="/bookmarks" method="POST" id="searcher-form" name="searcher-form">
            <label for sort-by>Filter by:</label>
                <select id="sort-by-selector" name="sort-by-selector" onChange=sortResultsBy()>
                    {% if sorting_type == "Last 7 days" %}
                        <option value="Last 7 days" selected>Last 7 days</option>
                    {% else %}
                        <option value="Last 7 days">Last 7 days</option>
                    {% endif %}
                    {% if sorting_type == "Last 14 days" %}
                        <option value="Last 14 days" selected>Last 14 days</option>
                    {% else %}
                        <option value="Last 14 days">Last 14 days</option>
                    {% endif %}
                    {% if sorting_type == "Last 30 days" %}
                        <option value="Last 30 days" selected>Last 30 days</option>
                    {% else %}
                        <option value="Last 30 days">Last 30 days</option>
                    {% endif %}
                </select>
            <input type="hidden" id="hid-b-page" name="hid-b-page" value="{{ current_bookmarks_page }}">
        </form>
    </div>
    <div>
        <a name="bookmarks_list"><h2 class="vulnerability_type">New Exploits</h2></a>
        <table class="results-table">
            <tr class="results-table">
                <th class="file">File</th>
                <th class="description">Description</th>
                <th class="date">Date</th>
                <th class="author">Author</th>
                <th class="vul-type">Type</th>
                <th class="platform">Platform</th>
                <th class="port">Port</th>
            </tr>
            {% if exploits_list|length > 0 %}
                {% for exploit in exploits_list %}
                    <tr class="results-table">
                        <td class="file"><a href="/exploit-details?exploit-id={{ exploit.id }}">{% autoescape off %}{{ exploit.file }}{% endautoescape %}</a></td>
                        <td class="description">{% autoescape off %}{{ exploit.description }}{% endautoescape %}</td>
                        <td class="date">{{ exploit.date }}</td>
                        <td class="author">{% autoescape off %}{{ exploit.author }}{% endautoescape %}</td>
                        <td class="vul-type">{{ exploit.type }}</td>
                        <td class="platform">{{ exploit.platform }}</td>
                        <td class="port">{% autoescape off %}{{ exploit.port }}{% endautoescape %}</td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr class="results-table">
                    <td class="empty-list" colspan="7">No Exploits available</td>
                </tr>
            {% endif %}
        </table>
        {% if exploits_list|length > 0 %}
            <div class="nav-page">
                <input type="button" id="first-bookmark-page-btn" name="first-bookmark-page-btn" class="nav-page" value="First" onclick="goFirstBookmarksPage()">
                <input type="button" id="previous-bookmark-page-btn" name="previous-bookmark-page-btn" class="nav-page" value="Previous" onclick="previousBookmarksPage()">
                <label for="bookmark-page-number" id="bookmark-page-label" name="bookmark-page-label" class="nav-page">Page:</label>
                <input type="number" id="bookmark-page-number" name="bookmark-page-number" class="nav-page" value="{{ current_bookmarks_page }}" min="1" max="{{ latest_bookmarks_page }}">
                <input type="button" id="go-bookmark-page-btn" name="go-bookmark-page-btn" class="nav-page" value="Go" onclick="goBookmarksPage()">
                <input type="button" id="next-bookmark-page-btn" name="next-bookmark-page-btn" class="nav-page" value="Next" onclick="nextBookmarksPage('{{ latest_bookmarks_page }}')">
                <input type="button" id="last-bookmark-page-btn" name="last-bookmark-page-btn" class="nav-page" value="Last" onclick="goLastBookmarksPage('{{ latest_bookmarks_page }}')">
            </div>
        {% endif %}
    </div>
{% endblock %}
